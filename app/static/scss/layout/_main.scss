/* ===== Main (área de conteúdo) =====
   Depende de: --bg-color, --text, --font, --header-h, --footer-h
*/

html, body{ height:100%; margin:0; }
body{ display:flex; flex-direction:column; }

/* utilitário container */
.container{ width:100%; max-width:900px; margin:0 auto; padding:0 1rem; }

/* main padrão (SEM reservar o footer de novo) */
main{
  flex:1;
  display:flex; flex-direction:column; align-items:center; justify-content:flex-start;
  background: var(--bg-color);

  /* ===== alturas base + fallbacks ===== */
  /* baseline para navegadores antigos */
  min-height: calc(100vh - var(--header-h));
  /* dinâmico (considera UI móvel) */
  @supports (height: 100dvh){
    min-height: calc(100dvh - var(--header-h));
  }
  /* estável (sem mudanças com UI) — se suportar, prefere svh */
  @supports (height: 100svh){
    min-height: calc(100svh - var(--header-h));
  }

  /* respiro normal; sem somar --footer-h aqui */
  padding: 2rem 1rem 2rem;

  /* fallback + moderno */
  overflow-x: hidden;  /* fallback */
  overflow-x: clip;    /* moderno */
  overflow-y: auto;

  /* telas que desabilitam o scroll do main quando há preview */
  &.with-preview{ overflow-y: visible; }

  /* wrapper dropzone + preview (merge/split/compress) */
  .upload-preview-wrapper{
    display:flex; flex-wrap:wrap; gap:1.5rem; align-items:flex-start;
    width:100%; max-width:900px; margin:0 auto;

    .dropzone-container{ flex:1 1 300px; }
  }

  /* preview com scroll próprio (aqui sim desconta o footer) */
  &.with-preview .preview-container{
    min-height: 0;                   /* destrava scroll do filho */
    overflow-y: auto;
    overscroll-behavior: contain;    /* evita “arrastar” o body */
    scrollbar-gutter: stable both-edges;

    /* baseline */
    max-height: calc(100vh - var(--header-h) - var(--footer-h) - 7rem);
    /* dinâmico */
    @supports (height: 100dvh){
      max-height: calc(100dvh - var(--header-h) - var(--footer-h) - 7rem);
    }
    /* estável */
    @supports (height: 100svh){
      max-height: calc(100svh - var(--header-h) - var(--footer-h) - 7rem);
    }
  }
}

/* pílulas de navegação: sempre acima do footer fixo */
.btn-wrapper.nav-buttons{
  margin: 2rem auto calc(1.25rem + var(--footer-h) + env(safe-area-inset-bottom, 0px));
}

@supports (margin: constant(safe-area-inset-bottom)){
  .btn-wrapper.nav-buttons{
    margin-bottom: calc(1.25rem + var(--footer-h) + constant(safe-area-inset-bottom, 0px));
  }
}

/* hero da home */
.home-hero{ width:100%; max-width:1100px; margin:0 auto; padding:2rem 1rem; }
.home-hero__title{
  text-align:center; color: var(--text);
  font:700 clamp(1.25rem, 2vw + 1rem, 1.8rem)/1.3 var(--font);
  margin:0 0 1.25rem;
}

/* mobile: cartões menores */
@media (max-width: 720px){ .action-card{ min-height:112px; } }

/* dropzone overlay 100% clicável */
.dropzone{ position:relative; }
.dz-input-overlay{ position:absolute; inset:0; width:100%; height:100%; opacity:0; cursor:pointer; }

/* ===== Centralização para páginas com 1 card ===== */
main.main--center{
  justify-content:center;

  /* área útil = viewport - header - footer */
  /* baseline */
  min-height: calc(100vh - var(--header-h) - var(--footer-h));
  /* dinâmico */
  @supports (height: 100dvh){
    min-height: calc(100dvh - var(--header-h) - var(--footer-h));
  }
  /* estável */
  @supports (height: 100svh){
    min-height: calc(100svh - var(--header-h) - var(--footer-h));
  }

  /* respiros simétricos; bottom só a safe-area */
  padding-top: 2rem;
  padding-bottom: env(safe-area-inset-bottom, 0px);
}

/* com preview, ancora no topo e repõe o respiro maior */
main.main--center.has-preview{
  justify-content: flex-start;

  /* baseline */
  min-height: calc(100vh - var(--header-h));
  /* dinâmico */
  @supports (height: 100dvh){
    min-height: calc(100dvh - var(--header-h));
  }
  /* estável */
  @supports (height: 100svh){
    min-height: calc(100svh - var(--header-h));
  }

  padding-bottom:
    calc(1.5rem + var(--footer-h) + env(safe-area-inset-bottom, 0px));
}

/* fallback automático (sem JS) se suportar :has() */
@supports selector(:has(*)){
  main.main--center:not(.has-preview):has(.preview-container .page){
    justify-content:flex-start;
  }
}
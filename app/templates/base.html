{% from "macros.html" import css_links %}
<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Grupo Vital PDFs{% endblock %}</title>

  <!-- Fontes e CSS -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  {{ css_links() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css', v=APP_VERSION|default('1')) }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">

  <!-- CSRF/CSP -->
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <meta name="csp-nonce" content="{{ csp_nonce() }}">
  <meta name="color-scheme" content="light dark">

  <!-- Guard SES/lockdown (antes dos módulos) -->
  <script src="{{ url_for('static', filename='js/ses-guard.js', v=APP_VERSION|default('1')) }}"
          nonce="{{ csp_nonce() }}"></script>

  <!-- pdf.js local (scripts clássicos) -->
  <script defer src="{{ url_for('static', filename='pdfjs/pdf.min.js', v=APP_VERSION|default('1')) }}"></script>

  <!-- Setup do worker do pdf.js (clássico) -->
  <script
    defer
    src="{{ url_for('static', filename='js/pdfjs-setup.js', v=APP_VERSION|default('1')) }}"
    data-worker-src="{{ url_for('static', filename='pdfjs/pdf.worker.min.js', v=APP_VERSION|default('1')) }}"></script>

  {% block head_extra %}{% endblock %}

  <!-- Tema (global) -->
  <script defer src="{{ url_for('static', filename='js/theme.js', v=APP_VERSION|default('1')) }}"></script>
</head>
<body data-page-id="{{ page_id|default('') }}" {% if editor_enabled %}data-editor-enabled="true"{% endif %}>
  <header class="gv-header" role="banner">
    <div class="gv-header__inner container">
      <a class="gv-brand" href="{{ url_for('index') }}" aria-label="Página inicial">
        <img class="gv-brand__logo" src="{{ url_for('static', filename='GrupoVital_branca_horizontal.png') }}" alt="Grupo Vital">
        <span class="gv-brand__name">Grupo Vital</span>
      </a>

      <div class="gv-header__text">
        {% block header_text %}
          <h1 class="gv-title">Sejam bem-vindos</h1>
          <p class="gv-subtitle">A nossa ferramenta de transformação de dados.</p>
        {% endblock %}
      </div>

      <div class="gv-header__right">
        <button id="theme-toggle" class="gv-toggle" type="button" aria-pressed="false" aria-label="Alternar tema claro/escuro">
          <span class="icon-sun" aria-hidden="true">☀️</span>
          <span class="icon-moon" aria-hidden="true">🌙</span>
        </button>
      </div>
    </div>
  </header>

  {% block content %}{% endblock %}

  {# Variantes de footer por página via block "footer_class" #}
  <footer class="site-footer {% block footer_class %}{% endblock %}" role="contentinfo" aria-label="Rodapé">
    <div class="container footer-inner">
      <p class="footer-copy">© 2025 Grupo Vital corp — Todos os direitos reservados.</p>
      <span class="footer-version">v {{ APP_VERSION|default('alpha 0.5') }}</span>

      <!-- Contato global → abre o compose do Zimbra com "Para:" já preenchido -->
      <p class="footer__contact" id="footer-contact">
        Sugestões? Entre em contato comigo pelo email
        <a class="footer__contact-link"
           href="https://grupovital.penso.com.br/?view=compose&to=luisb@grupovital.com.br&subject=Contato%20-%20Grupo%20Vital"
           target="_blank" rel="noopener noreferrer">
          <strong>luisb@grupovital.com.br</strong>
        </a>. 💬
      </p>
    </div>
  </footer>

  <!-- Mede --footer-h/--header-h (CSP-safe) -->
  <script defer src="{{ url_for('static', filename='js/footer-offset.js', v=APP_VERSION|default('1')) }}"></script>

  {# MÓDULOS GLOBAIS — não incluir utils.js diretamente. 
     Páginas podem estender este bloco com {{ super() }} e anexar scripts específicos clássicos. #}
  {% block scripts %}
    <script type="module" src="{{ url_for('static', filename='js/preview-init.js', v=APP_VERSION|default('1')) }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/script.js',       v=APP_VERSION|default('1')) }}"></script>
  {% endblock %}
</body>
</html>
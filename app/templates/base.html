{% from "macros.html" import css_links %}
{% set APP_VERSION = config.get('APP_VERSION', '1') %}
<!DOCTYPE html>
<html lang="pt-br" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}Grupo Vital PDFs{% endblock %}</title>

  <!-- Fontes e CSS (CSP ok) -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  {{ css_links() }}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}?v={{ APP_VERSION|urlencode }}">
  <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">

  <!-- CSRF / CSP -->
  <meta name="csrf-token" content="{{ csrf_token() }}">
  <meta name="csp-nonce" content="{{ csp_nonce() }}">
  <meta name="color-scheme" content="light dark">

  <!-- Guard SES/lockdown (antes dos m√≥dulos) -->
  <script src="{{ url_for('static', filename='js/ses-guard.js') }}?v={{ APP_VERSION|urlencode }}"
          nonce="{{ csp_nonce() }}"></script>

  <!-- pdf.js (cl√°ssicos) -->
  <script defer src="{{ url_for('static', filename='pdfjs/pdf.min.js') }}?v={{ APP_VERSION|urlencode }}"></script>
  <script defer
          src="{{ url_for('static', filename='js/pdfjs-setup.js') }}?v={{ APP_VERSION|urlencode }}"
          data-worker-src="{{ url_for('static', filename='pdfjs/pdf.worker.min.js') }}?v={{ APP_VERSION|urlencode }}"></script>

  {% block head_extra %}{% endblock %}

  <!-- Tema (global) -->
  <script defer src="{{ url_for('static', filename='js/theme.js') }}?v={{ APP_VERSION|urlencode }}"></script>
</head>
<body data-page-id="{{ page_id|default('') }}"
      {% if editor_enabled %}data-editor-enabled="true"{% endif %}
      data-fab-safe="240">

  <header class="gv-header" role="banner">
    <div class="gv-header__inner container">
      <a class="gv-brand" href="{{ url_for('index') }}" aria-label="P√°gina inicial">
        <img class="gv-brand__logo" src="{{ url_for('static', filename='GrupoVital_branca_horizontal.png') }}" alt="Grupo Vital">
        <span class="gv-brand__name">Grupo Vital</span>
      </a>

      <div class="gv-header__text">
        {% block header_text %}
          <h1 class="gv-title">Sejam bem-vindos</h1>
          <p class="gv-subtitle">A nossa ferramenta de transforma√ß√£o de dados.</p>
        {% endblock %}
      </div>

      <div class="gv-header__right">
        <button id="theme-toggle" class="gv-toggle" type="button" aria-pressed="false" aria-label="Alternar tema claro/escuro">
          <span class="icon-sun" aria-hidden="true">‚òÄÔ∏è</span>
          <span class="icon-moon" aria-hidden="true">üåô</span>
        </button>
      </div>
    </div>
  </header>

  {% block content %}{% endblock %}

  <!-- FOOTER padr√£o ‚Äî compacto em TODAS as p√°ginas -->
  <footer class="site-footer footer--contact-left footer--flush-right footer--compact {% block footer_class %}{% endblock %}"
          role="contentinfo" aria-label="Rodap√©">
    <div class="footer-inner">
      <!-- ¬© centro -->
      <p class="footer-copy">¬© 2025 Grupo Vital corp ‚Äî Todos os direitos reservados.</p>

      <!-- P√≠lula de vers√£o (direita) -->
      <span class="footer-version" aria-label="Vers√£o do aplicativo">
        v {{ APP_VERSION|default('alpha 0.5') }}
      </span>

      <!-- Contato (esquerda) -->
      <p class="footer__contact" id="footer-contact">
        Sugest√µes? Entre em contato comigo pelo email
        <a class="footer__contact-link"
           href="https://grupovital.penso.com.br/?view=compose&amp;to=luisb@grupovital.com.br&amp;subject=Contato%20-%20Grupo%20Vital"
           target="_blank" rel="noopener noreferrer">
          <strong>luisb<wbr>@grupovital<wbr>.com<wbr>.br</strong>
        </a>. üí¨
      </p>
    </div>
  </footer>

  <!-- Mede --footer-h e reserva segura lateral (CSP-safe) -->
  <script defer src="{{ url_for('static', filename='js/footer-offset.js') }}?v={{ APP_VERSION|urlencode }}"></script>

  {% block scripts %}
    <!-- Entry points em ES Modules (cada p√°gina importa seus m√≥dulos) -->
    <script type="module" src="{{ url_for('static', filename='js/preview-init.js') }}?v={{ APP_VERSION|urlencode }}"></script>
    <script type="module" src="{{ url_for('static', filename='js/script.js') }}?v={{ APP_VERSION|urlencode }}"></script>
  {% endblock %}
</body>
</html>
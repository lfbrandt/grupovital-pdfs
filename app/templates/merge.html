{% extends "base.html" %}

{% block title %}Juntar os PDFs{% endblock %}

{% block header_text %}
  <h2>Juntar os PDFs</h2>
{% endblock %}

{% block content %}
<main>
  <div class="container">
    {% set prefix = 'merge' %}

    <section class="card card--glass">
      <div class="dropzone-container">
        <div
          id="dropzone-{{ prefix }}"
          class="dropzone"
          data-preview="#preview-{{ prefix }}"
          data-spinner="#spinner-{{ prefix }}"
          data-action="#btn-{{ prefix }}"
          data-extensions=".pdf"
          data-multiple="true"
        >
          <input
            type="file"
            id="input-{{ prefix }}"
            name="files"
            accept=".pdf"
            multiple
            class="dz-input-overlay"
            aria-label="Selecionar PDFs para juntar"
          >
          <span>Arraste os arquivos aqui ou clique para selecionar</span>
        </div>
      </div>

      <div id="spinner-{{ prefix }}" class="overlay-spinner hidden" aria-hidden="true">
        <div class="loader"></div>
      </div>

      <button id="btn-{{ prefix }}" type="button" class="btn btn-primary" disabled>
        Juntar PDFs
      </button>

      <div id="preview-{{ prefix }}" class="preview-grid mt-preview"></div>
    </section>

    <div class="loading-area">
      <div id="mensagem-feedback" class="hidden"></div>
      <div id="loading-spinner" class="hidden">Processando...</div>
      <div id="progress-container" class="progress-container hidden">
        <div id="progress-bar" class="progress-bar"></div>
      </div>
    </div>

    <div class="btn-wrapper nav-buttons">
      <a href="{{ url_for('index') }}" class="btn btn-secondary">Página Inicial</a>
      <a href="{{ url_for('converter_page') }}" class="btn btn-secondary">Conversão</a>
      <a href="{{ url_for('split_page') }}" class="btn btn-secondary">Dividir PDF</a>
      <a href="{{ url_for('compress_page') }}" class="btn btn-secondary">Comprimir PDF</a>
    </div>
  </div>
</main>
{% endblock %}

{% block scripts %}
  <script nonce="{{ csp_nonce() }}" type="module" src="{{ url_for('static', filename='pdfjs/pdf.min.js') }}" defer></script>
  <script nonce="{{ csp_nonce() }}" type="module" src="{{ url_for('static', filename='pdfjs/pdf.worker.min.js') }}" defer></script>
  <script nonce="{{ csp_nonce() }}" type="module" src="{{ url_for('static', filename='js/pdf-config.js') }}" defer></script>
  <script nonce="{{ csp_nonce() }}" type="module" src="{{ url_for('static', filename='js/script.js') }}" defer></script>
{% endblock %}
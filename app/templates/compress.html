{% extends "base.html" %}

{% block title %}Comprimir PDF{% endblock %}

{% block header_text %}
  <h2>Comprimir PDF</h2>
{% endblock %}

{% block content %}
<main>
  <div class="container">
    {% import 'macros.html' as macros %}
    {% set prefix = 'compress' %}
    <section class="card preview-container">
      <form action="{{ url_for('compress.compress') }}"
            method="post"
            enctype="multipart/form-data">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <label for="input-{{ prefix }}">Escolha um arquivo PDF:</label>
        <div class="dropzone-container">
          <div
            id="dropzone-{{ prefix }}"
            class="dropzone"
            data-preview="#preview-{{ prefix }}"
            data-spinner="#spinner-{{ prefix }}"
            data-action="#btn-{{ prefix }}"
            data-extensions=".pdf"
            data-multiple="false"
          >
            <input
              type="file"
              name="file"
              id="input-{{ prefix }}"
              accept=".pdf"
            >
            Arraste o arquivo aqui ou clique para selecionar
          </div>
        </div>

        <div
          id="spinner-{{ prefix }}"
          class="overlay-spinner hidden"
          aria-hidden="true"
        >
          <div class="loader"></div>
        </div>

        <button
          id="btn-{{ prefix }}"
          type="submit"
          class="btn btn-primary"
          disabled
        >
          Comprimir PDF
        </button>
      </form>

      <div
        id="preview-{{ prefix }}"
        class="preview-grid mt-preview"
      ></div>
    </section>

    <div class="loading-area">
      <div id="mensagem-feedback" class="hidden"></div>
      <div id="loading-spinner" class="hidden">Processando...</div>
      <div id="progress-container" class="progress-container hidden">
        <div id="progress-bar" class="progress-bar"></div>
      </div>
    </div>

    <div class="btn-wrapper nav-buttons">
      <a href="{{ url_for('index') }}" class="btn btn-secondary">Página Inicial</a>
      <a href="{{ url_for('converter_page') }}" class="btn btn-secondary">Conversão</a>
      <a href="{{ url_for('merge_page') }}" class="btn btn-secondary">Juntar PDFs</a>
      <a href="{{ url_for('split_page') }}" class="btn btn-secondary">Dividir PDF</a>
    </div>
  </div>
</main>
{% endblock %}

{% block scripts %}
  {{ super() }}
  <script nonce="{{ csp_nonce() }}" type="module" src="{{ url_for('static', filename='js/api.js') }}" defer></script>
{% endblock %}